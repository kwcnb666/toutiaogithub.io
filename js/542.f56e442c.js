"use strict";(self["webpackChunktoutiao"]=self["webpackChunktoutiao"]||[]).push([[542],{1542:function(t,a,e){e.r(a),e.d(a,{default:function(){return p}});var n=function(){var t=this,a=t._self._c;return a("div",[a("div",{staticClass:"adiv"},[a("van-icon",{staticClass:"myicon",attrs:{name:"arrow-left"},on:{click:function(a){return t.$router.back()}}}),a("h1",[t._v("修改个人信息")])],1),a("div",{staticClass:"mytouxiang"},[a("van-image",{staticClass:"touxiang",attrs:{round:"",src:t.avatar},on:{click:t.btn}})],1),a("van-uploader",{attrs:{"after-read":t.afterRead,multiple:""},on:{"click-upload":t.dian}},[a("van-button",{attrs:{icon:"plus"}},[t._v("更改头像")])],1),a("van-field",{attrs:{name:"sex",label:"修改性别"},scopedSlots:t._u([{key:"input",fn:function(){return[a("van-radio-group",{attrs:{direction:"horizontal"},model:{value:t.sex,callback:function(a){t.sex=a},expression:"sex"}},[a("van-radio",{attrs:{name:"男"}},[t._v("男")]),a("van-radio",{attrs:{name:"女"}},[t._v("女")])],1)]},proxy:!0}])}),a("van-cell-group",[a("van-field",{attrs:{label:"修改名字",placeholder:"请输入名字"},model:{value:t.nickname,callback:function(a){t.nickname=a},expression:"nickname"}}),a("van-field",{attrs:{label:"修改生日",placeholder:"请输入生日"},model:{value:t.birthday,callback:function(a){t.birthday=a},expression:"birthday"}}),a("van-field",{attrs:{readonly:"",clickable:"",name:"datetimePicker",value:t.value,label:"时间选择",placeholder:"点击选择时间"},on:{click:function(a){t.showPicker=!0}}}),a("van-popup",{attrs:{position:"bottom"},model:{value:t.showPicker,callback:function(a){t.showPicker=a},expression:"showPicker"}},[a("van-datetime-picker",{attrs:{type:"date",title:"选择年月日","min-date":t.minDate,"max-date":t.maxDate},on:{confirm:t.onConfirm,cancel:function(a){t.showPicker=!1}},model:{value:t.currentDate,callback:function(a){t.currentDate=a},expression:"currentDate"}})],1)],1),a("van-cell",{attrs:{value:"","is-link":""},on:{click:t.change},scopedSlots:t._u([{key:"title",fn:function(){return[a("van-tag",{attrs:{type:"danger"}},[t._v("确认修改")])]},proxy:!0}])})],1)},o=[],i=(e(7658),e(70)),r=e(2419),s=e(6471);function l(t){var a=t.getFullYear(),e=t.getMonth()+1;e=e<10?"0"+e:e;var n=t.getDate();n=n<10?"0"+n:n;t.getHours();var o=t.getMinutes();o=o<10?"0"+o:o;var i=t.getSeconds();return i=i<10?"0"+i:i,a+"-"+e+"-"+n}var c={name:"genggai",components:{[s.Z.Component.name]:s.Z.Component},data(){return{minDate:new Date(2020,0,1),maxDate:new Date(2025,10,1),currentDate:new Date(2021,0,17),value:"",showPicker:!1,token:"",nickname:"",birthday:"",sex:"",avatar:"",loginfo:JSON.parse(sessionStorage.getItem("loginfo")),myinfo:[],date:"",show:!1}},created(){(0,r.Pp)({token:this.loginfo.token}).then((t=>{console.log("result: ",t),this.nickname=t.data.userInfo.nickname,this.birthday=t.data.userInfo.birthday,this.sex=t.data.userInfo.sex,this.avatar=t.data.userInfo.avatar})).catch((t=>{console.log("err: ",t)}))},methods:{onConfirm(t){console.log("value: ",t),this.birthday=l(t),this.showPicker=!1},btn(){(0,s.Z)([this.avatar])},dian(){i.ZP.get("https://d33a5037-6c63-4e92-8bb1-30018ab701ea.bspapp.com/http/upload/token").then((t=>{console.log("huoqu: ",t),this.token=t.data.token})).catch((t=>{console.log("huoqu: ",t)}))},afterRead(t){let a=new FormData;a.append("token",this.token),a.append("file",t.file),a.append("key",this.nanoid+t.file.name),i.ZP.post("https://upload-z1.qiniup.com",a,{"Content-Type":"multipart/form-data"}).then((t=>{console.log("result: ",t),this.avatar="http://toutiao.longxiaokj.com/"+t.data.key,console.log("first","http://toutiao.longxiaokj.com/"+t.data.key)})).catch((t=>{console.log("err: ",t)}))},change(){i.ZP.post("https://d33a5037-6c63-4e92-8bb1-30018ab701ea.bspapp.com/http/user/editUserInfo",{uid:this.loginfo.uid,avatar:this.avatar,nickname:this.nickname,birthday:this.birthday,sex:this.sex}).then((t=>{console.log("result: ",t),this.$toast(t.data.msg),t.data.msg&&this.$router.push("/home")})).catch((t=>{console.log("err: ",t)}))}}},u=c,d=e(1001),h=(0,d.Z)(u,n,o,!1,null,"7f088b1a",null),p=h.exports}}]);
//# sourceMappingURL=542.f56e442c.js.map