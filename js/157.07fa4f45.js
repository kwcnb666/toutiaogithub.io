"use strict";(self["webpackChunktoutiao"]=self["webpackChunktoutiao"]||[]).push([[157],{157:function(t,i,e){e.r(i),e.d(i,{default:function(){return u}});var n=function(){var t=this,i=t._self._c;return i("div",[i("div",{staticClass:"adiv"},[i("van-icon",{staticClass:"myicon",attrs:{name:"arrow-left"},on:{click:function(i){return t.$router.back()}}}),i("h1",[t._v("文章详情")])],1),i("div",{staticClass:"guding"},[i("div",{staticClass:"list"},[i("h1",[t._v(t._s(t.list?.title))]),i("div",{staticClass:"title"},[i("div",{staticClass:"myimg"},[i("img",{attrs:{src:t.list?.avatar,alt:""},on:{error:t.myerror}})]),i("div",{staticClass:"info"},[i("h2",[t._v(t._s(t.list?.nickname))]),i("p",[i("span",[t._v(" "+t._s(new Date(parseInt(t.list?.time)).toLocaleString().replace(/:\d{1,2}$/,"")))])])]),t.list?.is_fav?i("div",{staticClass:"guanzhu",on:{click:t.unadd}},[t._v("已关注")]):i("div",{staticClass:"guanzhu1",on:{click:t.add}},[t._v("+关注")])]),i("van-divider",{style:{color:t.myColor,borderColor:t.myColor,padding:"0 16px"}},[t._v(" 内容 ")]),i("div",{staticClass:"msg"},[i("p",[t._v(t._s(t.list?.content))]),t._l(t.list?.imageSrc,(function(e){return i("img",{staticClass:"imgmy",attrs:{src:e,alt:""},on:{click:function(i){return t.btn(e)}}})}))],2)],1),i("div",{staticClass:"pinglun"},[i("div",{staticClass:"tit"},[i("h6",[t._v("评论"+t._s(t.list?.comment))]),i("p",[i("span",[t._v(t._s(t.list?.like)+"赞")]),t._v("||"),i("span",[t._v("转发"+t._s(t.list?.fav))])])]),t._l(t.pllist,(function(e){return i("div",{key:e.id,staticClass:"content"},[i("div",{staticClass:"tit"},[i("div",{staticClass:"mytouxiang"},[i("van-image",{staticClass:"touxiang",attrs:{round:"",src:e.info.avatar}})],1),i("h5",[t._v(t._s(e.info.nickname))]),i("p",[e.is_like?i("van-icon",{attrs:{name:"good-job",color:t.myColor},on:{click:function(i){return t.ungood(e._id)}}}):i("van-icon",{attrs:{name:"good-job-o"},on:{click:function(i){return t.good(e._id)}}}),t._v(" "+t._s(e.like_count)+" ")],1)]),i("div",{staticClass:"con"},[i("h3",[t._v(t._s(e.content))]),i("p",[t._v(t._s(new Date(parseInt(e.create_time)).toLocaleString())+" "),i("button",{on:{click:function(i){return t.huifuta(e._id)}}},[t._v("回复他")])])]),i("div",{staticClass:"huifu"},[t._l(t.huifu,(function(n){return e._id==n.reply_comment_id?i("div",{staticClass:"huifulist"},[i("div",{staticClass:"yi"},[i("img",{attrs:{src:n.info.avatar,alt:""}}),i("li",[t._v(t._s(n.info.nickname)+">>回复>>"+t._s(e.info.nickname))])]),i("div",{staticClass:"er"},[i("li",[t._v(t._s(n.content))]),i("p",[t._v(t._s(t.timeAgo(n.create_time)))])])]):t._e()})),i("p",{on:{click:function(i){return t.zhankai(e._id)}}},[t._v(t._s(t.nonetext))])],2)])}))],2)]),i("div",{staticClass:"fbottom"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.pinglun,expression:"pinglun"}],attrs:{type:"text",name:"",id:"",placeholder:"善于结善缘，恶言伤人心~~"},domProps:{value:t.pinglun},on:{keydown:function(i){return!i.type.indexOf("key")&&t._k(i.keyCode,"enter",13,i.key,"Enter")?null:t.publish()},input:function(i){i.target.composing||(t.pinglun=i.target.value)}}}),i("van-icon",{attrs:{name:"comment-o",badge:t.list.comment},on:{click:t.publish}}),t.list.is_like?i("van-icon",{attrs:{name:"like",color:t.myColor,badge:t.list.like},on:{click:t.unlike}}):i("van-icon",{attrs:{name:"like-o",badge:t.list.like},on:{click:t.like}}),t.list.is_fav?i("van-icon",{attrs:{name:"star",color:t.myColor,badge:t.list.fav},on:{click:t.unadd}}):i("van-icon",{attrs:{name:"star-o",badge:t.list.fav},on:{click:t.add}}),i("van-icon",{attrs:{name:"share-o"},on:{click:function(i){t.showShare=!0}}})],1),i("van-share-sheet",{attrs:{title:"立即分享给好友",options:t.options},on:{select:t.onSelect},model:{value:t.showShare,callback:function(i){t.showShare=i},expression:"showShare"}})],1)},s=[],a=e(23),o=e(6471),r=e(6817),c={name:"detailed",components:{[o.Z.Component.name]:o.Z.Component},data(){return{showShare:!1,options:[{name:"微信",icon:"wechat"},{name:"微博",icon:"weibo"},{name:"复制链接",icon:"link"},{name:"分享海报",icon:"poster"},{name:"二维码",icon:"qrcode"}],item_id:this.$route.query.item_id,cate_id:this.$route.query.cate_id,list:[],pllist:[],pinglun:"",huifu:[],loginfo:JSON.parse(sessionStorage.getItem("loginfo")),none:!1,nonetext:"——————展开回复",dangqian:[],type:0}},methods:{huifuta(t){(0,a.DR)({user_id:this.loginfo.uid,article_id:this.item_id,content:this.pinglun,reply_comment_id:t,comment_type:1}).then((t=>{this.$toast("回复成功了"),this.$notify({type:"danger",message:"回复成功了"}),this.comment(),"评论成功"==t.data.msg&&(this.pinglun="")})).catch((t=>{console.log("err: ",t)}))},timeAgo(t){return(0,r.y)(t)},zhankai(t){console.log("id: ",t),(0,a.vi)({skip:0,limit:10,user_id:this.loginfo._id,reply_comment_id:t,article_id:this.item_id}).then((t=>{this.huifu=t.data.data,0==this.huifu.length&&(this.$toast("我没有评论回复哦"),this.$notify({type:"danger",message:"我没有评论回复哦"}))})).catch((t=>{console.log("err: ",t)}))},btn(t){(0,o.Z)([t])},myerror(t){t.target.src=e(5551)},onSelect(t){this.$toast(t.name),this.showShare=!1},comment(){(0,a.ec)({article_id:this.item_id,skip:0,limit:100,user_id:this.cate_id}).then((t=>{console.log("result: ",t),this.pllist=t.data.data})).catch((t=>{console.log("err: ",t)}))},detailde(){(0,a.L_)({article_id:this.item_id,user_id:this.cate_id}).then((t=>{this.list=t.data.data,this.islike=t.data.data.islike})).catch((t=>{console.log("err: ",t)}))},publish(){(0,a.DR)({user_id:this.loginfo.uid,article_id:this.item_id,content:this.pinglun,reply_comment_id:"",comment_type:0}).then((t=>{this.$toast(t.data.msg),this.$notify({type:"danger",message:t.data.msg}),this.comment(),"评论成功"==t.data.msg&&(this.pinglun="")})).catch((t=>{console.log("err: ",t)}))},like(){(0,a.mf)({user_id:this.loginfo.uid,article_id:this.item_id}).then((t=>{this.$toast(t.data.msg),this.$notify({type:"danger",message:t.data.msg}),this.detailde()})).catch((t=>{console.log("err: ",t)}))},unlike(){(0,a.Pj)({user_id:this.loginfo.uid,article_id:this.item_id}).then((t=>{this.$toast(t.data.msg),this.$notify({type:"danger",message:t.data.msg}),this.detailde()})).catch((t=>{console.log("err: ",t)}))},add(){(0,a.NS)({user_id:this.loginfo.uid,article_id:this.item_id}).then((t=>{this.$toast(t.data.msg),this.$notify({type:"danger",message:t.data.msg}),this.detailde()})).catch((t=>{console.log("err: ",t)}))},unadd(){(0,a.t)({user_id:this.loginfo.uid,article_id:this.item_id}).then((t=>{this.$toast(t.data.msg),this.$notify({type:"danger",message:t.data.msg}),this.detailde()})).catch((t=>{console.log("err: ",t)}))},good(t){(0,a.H$)({user_id:this.cate_id,comment_id:t}).then((t=>{this.$toast(t.data.msg),this.$notify({type:"danger",message:t.data.msg}),this.comment()})).catch((t=>{console.log("err: ",t)}))},ungood(t){(0,a.sq)({user_id:this.cate_id,comment_id:t}).then((t=>{this.$toast(t.data.msg),this.$notify({type:"danger",message:t.data.msg}),this.comment()})).catch((t=>{console.log("err: ",t)}))}},created(){this.detailde(),this.comment()}},l=c,d=e(1001),m=(0,d.Z)(l,n,s,!1,null,"785d707d",null),u=m.exports},23:function(t,i,e){e.d(i,{DR:function(){return d},H$:function(){return m},L_:function(){return s},NS:function(){return c},Pj:function(){return r},ec:function(){return a},mf:function(){return o},sq:function(){return u},t:function(){return l},vi:function(){return h}});var n=e(1481);const s=t=>n.Z.post("api/get_article_detail",t),a=t=>n.Z.post("/api/get_comment_list",t),o=t=>n.Z.post("/api/like",t),r=t=>n.Z.post("api/unlike",t),c=t=>n.Z.post("/api/add_fav",t),l=t=>n.Z.post("/api/remove_fav",t),d=t=>n.Z.post("/api/add_comment",t),m=t=>n.Z.post("/api/comment_like",t),u=t=>n.Z.post("/api/comment_unlike",t),h=t=>n.Z.post("/api/get_reply_list",t)},6817:function(t,i,e){function n(t){var i=new Date(t),e=i.getTime(),n=6e4,s=60*n,a=24*s,o=7*a,r=30*a,c=12*r,l=(new Date).getTime(),d=l-e,m="";d<0&&(m="未来");var u=d/n,h=d/s,_=d/a,g=d/o,p=d/r,v=d/c;return v>=1?m=" "+parseInt(v)+"年前":p>=1&&p<12?m=" "+parseInt(p)+"月前":g>=1&&g<5&&_>6&&p<1?m=" "+parseInt(g)+"周前":_>=1&&_<=6?m=" "+parseInt(_)+"天前":h>=1&&h<=23?m=" "+parseInt(h)+"小时前":u>=1&&u<=59?m=" "+parseInt(u)+"分钟前":d>=0&&d<=n&&(m="刚刚"),m}e.d(i,{y:function(){return n}})},5551:function(t,i,e){t.exports=e.p+"img/error.934d6585.png"}}]);
//# sourceMappingURL=157.07fa4f45.js.map