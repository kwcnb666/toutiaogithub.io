"use strict";(self["webpackChunktoutiao"]=self["webpackChunktoutiao"]||[]).push([[280],{6280:function(t,e,i){i.r(e),i.d(e,{default:function(){return d}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"home"},[e("div",{staticClass:"adiv"},[e("van-icon",{staticClass:"icon",attrs:{name:"arrow-left"},on:{click:function(e){return t.$router.back()}}}),e("h1",[t._v("发布")])],1),e("div",{staticClass:"kongbai"}),e("van-cell-group",[e("van-field",{attrs:{placeholder:"请输入标题"},model:{value:t.tit,callback:function(e){t.tit=e},expression:"tit"}})],1),e("div",{staticClass:"kongbai"}),e("van-field",{attrs:{rows:"2",autosize:"",type:"textarea",maxlength:"50",placeholder:"请输入内容","show-word-limit":""},model:{value:t.msg,callback:function(e){t.msg=e},expression:"msg"}}),e("div",{staticClass:"kongbai"}),e("van-field",{attrs:{readonly:"",clickable:"",name:"picker",value:t.value,label:"选择分类名字",placeholder:"点击选择分类名字"},on:{click:function(e){t.showPicker=!0}}}),e("van-popup",{attrs:{position:"bottom"},model:{value:t.showPicker,callback:function(e){t.showPicker=e},expression:"showPicker"}},[e("van-picker",{attrs:{"show-toolbar":"",columns:t.columns},on:{confirm:t.onConfirm,cancel:function(e){t.showPicker=!1}}})],1),e("van-uploader",{attrs:{"after-read":t.afterRead,multiple:""},on:{"click-upload":t.dian},model:{value:t.fileList,callback:function(e){t.fileList=e},expression:"fileList"}}),e("div",{staticClass:"yes",on:{click:t.btn}},[t._v("确定")])],1)},o=[];i(7658),i(3408),i(4590);let s=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce(((t,e)=>(e&=63,t+=e<36?e.toString(36):e<62?(e-26).toString(36).toUpperCase():e>62?"-":"_",t)),"");var n=i(70),l=i(2419),r={name:"fabu",data(){return{value:"",index:"",tit:"",msg:"",nanoid:s(),token:"",fileList:[],url:"",loginfo:JSON.parse(sessionStorage.getItem("loginfo")),columns:[],showPicker:!1,fenlei:[]}},created(){null==this.loginfo?this.$dialog.confirm({title:"警告警告··········警告警告",message:"臭小子，没有登录还想发布内容？？？？怎么可能呢嘿嘿嘿"}).then((()=>{this.$router.push("/login")})).catch((()=>{this.$toast("你小子取消是吧，那你别想进去了！！！！"),this.$notify({type:"danger",message:"你小子取消是吧，那你别想进去了！！！！"}),this.$router.push("/index")})):(this.$toast("您已进入发布页，请勿发布不良内容，否则将给予封号处理！！！"),this.$notify({type:"primary",message:"您已进入发布页，请勿发布不良内容，否则将给予封号处理！！！",duration:2e3})),(0,l.tg)().then((t=>{this.fenlei=t.data.data;for(let e=0;e<this.fenlei.length;e++)this.columns.push(this.fenlei[e].name)})).catch((t=>{}))},methods:{onConfirm(t,e){this.value=t,this.index=e,this.showPicker=!1},dian(){(0,l.jc)().then((t=>{console.log("result: ",t),this.token=t.data.token})).catch((t=>{console.log("err: ",t)}))},afterRead(t){let e=new FormData;e.append("token",this.token),e.append("file",t.file),e.append("key",this.nanoid+t.file.name),n.ZP.post("https://upload-z1.qiniup.com",e,{"Content-Type":"multipart/form-data"}).then((t=>{this.url="http://toutiao.longxiaokj.com/"+t.data.key,console.log("first","http://toutiao.longxiaokj.com/"+t.data.key)})).catch((t=>{console.log("err: ",t)}))},btn(){(0,l.aU)({title:this.tit,content:this.msg,cate_id:this.fenlei[this.index]._id,cate_name:this.value,author:this.loginfo.userInfo.nickname,author_id:this.loginfo.uid,imageSrc:[this.url]}).then((t=>{this.$toast(t.data.msg),this.$notify({type:"success",message:t.data.msg}),"成功"==t.data.msg&&(this.tit=this.msg=this.value=" ",this.fileList=[],this.$router.push("/index"))})).catch((t=>{console.log("err: ",t)}))}}},c=r,h=i(1001),u=(0,h.Z)(c,a,o,!1,null,"54d1b418",null),d=u.exports}}]);
//# sourceMappingURL=280.8b6d3ee0.js.map